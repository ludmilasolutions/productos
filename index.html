<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Listado de Precios - Ferreter√≠a Carnevale</title>
    <meta name="theme-color" content="#1a237e">
    <meta name="description" content="Buscador de productos de ferreter√≠a. Consulta precios y contacta por WhatsApp.">
    <link rel="stylesheet" href="styles.css">
    <link rel="preload" href="app.js" as="script">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõ†Ô∏è</text></svg>">
    <style>
        /* Critical CSS inline for faster initial paint */
        .critical-loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            z-index: 9999;
        }
        .critical-loading .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Critical loading state -->
    <div class="critical-loading" id="criticalLoading">
        <div class="spinner"></div>
        <p>Cargando sistema...</p>
    </div>

    <!-- Main app (hidden initially) -->
    <div class="app-container" id="appContainer" style="display: none;">
        <header class="app-header">
            <div class="header-content">
                <h1>üõ†Ô∏è FERRETER√çA CARNEVALE</h1>
                <p class="subtitle">Lista de precios - Buscador r√°pido</p>
                <div class="stats">
                    <span id="productCount">Cargando productos...</span>
                </div>
            </div>
        </header>

        <div class="search-section">
            <div class="search-box-container">
                <input 
                    type="search" 
                    id="searchInput" 
                    placeholder="Ej: martillo 500g, rodillo 22cm..." 
                    autocapitalize="off"
                    autocomplete="off"
                    enterkeyhint="search"
                    aria-label="Buscar productos"
                >
                <div class="search-actions">
                    <button id="clearBtn" class="icon-btn" aria-label="Limpiar b√∫squeda" style="display: none;">√ó</button>
                </div>
            </div>
            
            <div class="quick-filters">
                <select id="rubroFilter" class="mobile-select" aria-label="Filtrar por rubro">
                    <option value="">Todos los rubros</option>
                </select>
                <select id="sortFilter" class="mobile-select" aria-label="Ordenar resultados">
                    <option value="relevance">M√°s relevantes</option>
                    <option value="price_asc">Precio menor a mayor</option>
                    <option value="price_desc">Precio mayor a menor</option>
                </select>
            </div>
            
            <div class="search-hints">
                <small>üí° Busca por c√≥digo, descripci√≥n o marca. Ej: "A123", "llave inglesa", "truper"</small>
            </div>
        </div>

        <!-- Results info -->
        <div class="results-info" id="resultsInfo">
            <div class="info-content">
                <span id="resultsCount">-</span>
                <span id="searchTime" style="display: none;"></span>
            </div>
        </div>

        <!-- Products viewport -->
        <div class="products-viewport" id="productsViewport">
            <div class="products-container" id="productsContainer"></div>
            <div class="scroll-loader" id="scrollLoader" style="display: none;">
                <div class="mini-spinner"></div>
                <span>Cargando m√°s productos...</span>
            </div>
        </div>

        <!-- Empty states -->
        <div class="search-state empty-state" id="emptyState">
            <div class="state-icon">üîç</div>
            <h3>Busca productos</h3>
            <p>Escribe lo que necesitas en el buscador de arriba</p>
            <div class="state-tips">
                <p><strong>Consejos:</strong></p>
                <ul>
                    <li>Puedes buscar por c√≥digo, nombre o marca</li>
                    <li>Ej: "rodillo 22", "martillo bola", "flexible 35"</li>
                    <li>Usa filtros para refinar resultados</li>
                </ul>
            </div>
        </div>

        <div class="search-state no-results" id="noResults" style="display: none;">
            <div class="state-icon">üòï</div>
            <h3>No encontramos productos</h3>
            <p>Intenta con otras palabras o usa filtros diferentes</p>
            <button id="resetSearch" class="text-btn">Limpiar b√∫squeda</button>
        </div>

        <div class="search-state loading-state" id="loadingState" style="display: none;">
            <div class="state-icon">
                <div class="spinner"></div>
            </div>
            <h3>Cargando productos...</h3>
            <p>Estamos preparando el listado de precios</p>
        </div>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                <p><strong>Ferreter√≠a Carnevale</strong> ‚Ä¢ Lista actualizada semanalmente</p>
                <p class="footer-note">üí¨ Para consultas y compras, usa el bot√≥n WhatsApp de cada producto</p>
                <p class="footer-update" id="lastUpdate"></p>
            </div>
        </footer>
    </div>

    <!-- Product Modal -->
    <div class="modal-overlay" id="modalOverlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h2 id="modalTitle">Detalles del producto</h2>
                <button class="modal-close" id="modalClose" aria-label="Cerrar">√ó</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="btn-whatsapp-large" id="modalWhatsAppBtn">
                    <span class="whatsapp-icon">üí¨</span>
                    <span>Consultar por WhatsApp</span>
                </button>
            </div>
        </div>
    </div>

    <script src="app.js" defer></script>
</body>
</html>
